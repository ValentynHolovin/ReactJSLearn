<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>test</title>
    <link href="style.css" rel="stylesheet">
    <script src="https://unpkg.com/babel-standalone@6.15.0/babel.min.js"></script>
</head>
    <body>
    <h1>Test</h1>
    <div id = 'container'></div>
        <script type="text/javascript">
            var topic = "JavaScript";

            if (topic) {
                let topic = "React";
                console.log('block', topic);
            }
            console.log('global', topic);
            
            var div, 
                container = document.getElementById('container');
            
            for (let i = 0; i < 5; i++) {
                div = document.createElement('div');
                div.id = 'div';
                console.log(`i = ${i}`);
                div.onclick = function () {
                    alert('This is box #' + i);
                };
                container.appendChild(div);
            }

            testDefaultVar();

            var testArrowFunc = (string1, string2) => `${string1} and ${string2}`;
            console.log(testArrowFunc('bla-bla-bla', 'tro-lo-lo'));
            
            function testDefaultVar(name = "Valik", activity = "sleep") {
                console.log(`${name} loves ${activity}`);
            }

            var sandwich = {
                bread: "dutch crunch",
                meat: "tuna",
                cheese: "swiss",
                toppings: ["lettuce", "tomato", "mustard"]
            }

            var {bread, meat} = sandwich;
            console.log(bread, meat);

            bread = "garlic";
            meat = "turkey";

            console.log(bread, meat);
            console.log(sandwich.bread, sandwich.meat);

            var name = "Tallac";
            var elevation = 9738;

            var print = function () {
                console.log(`Mt. ${this.name} is ${this.elevation} feet tall`);
            }

            var funHike = {name, elevation, print};

            funHike.print();

            var name1 = "Valik";
            var sound = "go fast";

            const skier = {
                name1,
                sound,
                powderYell() {
                    let yell = this.sound.toLocaleUpperCase();
                    console.log(`${yell} ${yell} ${yell}!!!`);
                },
                speed(mph) {
                    this.speed = mph;
                    console.log('speed:', mph);
                }
            };

            skier.powderYell();
            skier.speed(350);
            console.log(JSON.stringify(skier));

            var lakes = ["Donner", "Marlette", "Fallen Leaf", "Cascade"];
            var [first, ...rest] = lakes;
            console.log(rest.join(", "));
            console.log(lakes.join(", "));

            function directions(...args) {
                var [start, ...remaning] = args;
                var [finish, ...stop] = remaning.reverse();

                console.log(`drive through ${args.length} towns`);
                console.log(`start in ${start}`);
                console.log(`the destination is ${finish}`);
                console.log(`stopping ${stop.length} times in between`);
            }

            directions("Truckee", "Tahoe City", "Sunnyside", "Homewood", "Tahoma");

            const getFakeMembers = count => new Promise((resolves, rejects) => {
                const api = `https://api.randomuser.me/?nat=US&results=${count}`;
                const request = new XMLHttpRequest();
                request.open('GET', api);
                request.onload = () =>
                    (request.status === 200) ?
                        resolves(JSON.parse(request.response).results) :
                        rejects(Error(request.statusText));
                request.onerror = (err) => rejects(err);
                request.send()
            });
            getFakeMembers(5).then(
                members => console.log(members),
                err => console.error(
                    new Error("cannot load members from randomuser.me"))
            );

            fetch("https://api.randomuser.me/?nat=US&results=10")
                .then(response => response.json())
                .then(members => console.log(members))
                .catch(err => console.error(err));

            class Vacation {
                constructor(destination, length) {
                    this.destination = destination;
                    this.length = length;
                }

                print() {
                    console.log(`${this.destination} will take ${this.length} days.`);
                }

            }

            const trip = new Vacation("Santiago, Chile", 9);
            trip.print();
            const oneSecond = () => 1000;
            const getCurrentTime = () => new Date();
            const clear = () => console.clear();
            const log = message => console.log(message);
            const compose = (...fns) => (arg) => fns.reduce((composed, f) => f(composed), arg);

            const serializeClockTime = date => ({
                hours: date.getHours(),
                minutes: date.getMinutes(),
                seconds: date.getSeconds()
            });

            const civilianHours = clockTime => ({
                ...clockTime,
                hours: (clockTime.hours > 12) ? clockTime.hours - 12 : clockTime.hours
            });

            const appendAMPM = clockTime => ({
                ...clockTime,
                ampm: (clockTime.hours >= 12) ? "PM" : "AM"
            });

            const display = target => time => target(time);

            const formatClock = format => time => format.replace("hh", time.hours)
                                                        .replace("mm", time.minutes)
                                                        .replace("ss", time.seconds)
                                                        .replace("tt", time.ampm);

            const prependZero = key => clockTime => ({
                ...clockTime,
                [key]: (clockTime[key] < 10) ? "0" + clockTime[key] : clockTime[key]
            });

            const convertToCivilianTime = clockTime => compose(
                appendAMPM,
                civilianHours
            )(clockTime);

            const doubleDigits = civilianTime => compose(
                prependZero("hours"),
                prependZero("minutes"),
                prependZero("seconds")
            )(civilianTime);

            const startTicking = () => setInterval( compose(
                clear,
                getCurrentTime,
                serializeClockTime,
                convertToCivilianTime,
                doubleDigits,
                formatClock("hh:mm:ss tt"),
                display(log)
            ), oneSecond());

            startTicking();
        </script>
</body>
</html>